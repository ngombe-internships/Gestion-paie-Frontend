<div #topElement class="scroll-target" style="height:1px;"></div>
<div class="container my-4 entreprise-parametre-rh-admin">

  <h2 class="display-4 fw-bold text-primary mb-0 text-center py-3">
    <i class="bi bi-people-fill me-3 "></i>
   Paramètres RH de l'entreprise
  </h2>
  <div *ngIf="entreprise" class="text-center mb-2 text-muted">
    <h4>
       <strong class="taille ">Entreprise :</strong> <span class="text-uppercase">  {{ entreprise.nom }} </span>
  </h4>
  </div>
  <div *ngIf="error" class="alert alert-danger text-center">{{ error }}</div>
  <div *ngIf="loading" class="alert alert-info text-center">Chargement...</div>

  <!-- FORMULAIRE EN HAUT -->
  <div class="card mb-4 shadow">
    <div class="card-header">
      <h5 class="mb-0">{{ editingParam ? "Modifier le paramètre" : "Sélectionnez un paramètre à modifier" }}</h5>
    </div>
    <div class="card-body">
      <form [formGroup]="form" (ngSubmit)="save()" autocomplete="off">
        <div class="row mb-3">
          <div class="col-md-3">
            <label class="form-label">Clé</label>
            <input class="form-control" formControlName="cleParametre">
          </div>
          <div class="col-md-6">
            <label class="form-label">Description</label>
            <input class="form-control" formControlName="description">
          </div>
          <div class="col-md-3">
            <label class="form-label">Valeur <span class="text-danger">*</span></label>
            <input class="form-control" formControlName="valeurParametre" [class.is-invalid]="form.get('valeurParametre')?.invalid && form.get('valeurParametre')?.touched">
            <div class="invalid-feedback" *ngIf="form.get('valeurParametre')?.invalid && form.get('valeurParametre')?.touched">
              Saisissez une valeur
            </div>
          </div>
        </div>
        <div class="text-end">
          <button type="submit" class="btn btn-outline-primary me-2" [disabled]="!editingParam">
            <i class="bi bi-check-circle"></i> Enregistrer
          </button>
          <button type="button" class="btn btn-outline-secondary" (click)="cancelEdit()" [disabled]="!editingParam">
            <i class="bi bi-x-circle"></i> Annuler
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- TABLEAU EN BAS -->
  <div class="card shadow">
    <div class="card-header">
      <h5 class="mb-0">Liste des paramètres</h5>
    </div>
    <div class="card-body p-0">
      <table class="table table-striped table-hover table-sm mb-0">
        <thead class="table-dark">
          <tr>
            <th>Clé</th>
            <th>Description</th>
            <th>Valeur</th>
            <th style="width:120px;">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let p of params">
            <td>{{ p.cleParametre }}</td>
            <td>{{ p.description || '-' }}</td>
            <td>{{ p.valeurParametre }}</td>
            <td>
              <button class="btn btn-outline-info btn-sm" (click)="startEdit(p)">
                <i class="bi bi-pencil"></i> Modifier
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
